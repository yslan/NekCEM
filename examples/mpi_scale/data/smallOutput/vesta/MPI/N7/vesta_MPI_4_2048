/----------------------------------------------------------\
|      _   __ ______ __ __  ______  ______   __  _____     |
|     / | / // ____// //_/ / ____/ / __ _ / / _|/ __  /    |
|    /  |/ // __/  / ,<   / /     / /__/   / / / / / /     |
|   / /|  // /___ / /| | / /_ _  / /___   /_/ / / / /      |
|  /_/ |_//_____//_/ |_|/_____/ /______/ /_/ /_/ /_/       |
|                                                          |
|----------------------------------------------------------|
|                                                          |
| NekCEM :  Nek5000 for Computational ElectroMagnetics     |
|           Open Source Spectal Element DG Maxwell Solver  |
| Source :  https://svn.mcs.anl.gov/repos/NEKCEM           |
|                                                          |
\----------------------------------------------------------/
                                                              

 Number of processors: 4
 REAL    wdsize      : 8
 INTEGER wdsize      : 4
 call data_init2
 IFCEM=  T
 
 Preprocessor options::  
   MOAB off at compile time
   MPI on: -DNO_MPI not defined
   GPU off at compile time
   OpenMP off: -DOMP not defined
 
 PDE/ODE Options:: 
   IFPDE=  T
   IFODE=  F  (quantum solver)
 
 Mesh options:: 
   IFHEX=  T  (hexahedral )
   IFTET=  F  (tetrahedral)
 
 Available basis:: 
   IFDG     =  T  (SEDG   )
   IFNEDELEC=  F  (Nedelec)


  Beginning session:
  /home/mmin/NEKCEM/trunk/examples/MPI_4_2048/b2048.rea                         

 
 done: data_init2:: 0.142304187500030821E-01  sec
 call read_init2
 timer accuracy:   1.4387500E-07 sec

 read .rea file
 NPSCAL/nfield/ldimt 0 1 1
 read .re2 file
 byte swap: T -0.2931277218E+36 6.543210030
 nelgt/nelgv/lelt:     2048     2048      512
 lx1  /lx2  /lx3 :        8        8        8
 call   mapelpr, mapping elements to processors
 call   set_proc_map()
 ifgtp/gfdm/zper F F F
 get_vert, ncrnr= 8
 ifgfdm F
           0         512         512        2048        2048 NELV
           1         512         512        2048        2048 NELV
           2         512         512        2048        2048 NELV
           3         512         512        2048        2048 NELV
 done:: set_proc_map()
 RANK     0 IEG    1537    1538    1539    1540    1541    1542    1543    1544
                   1545    1546    1547    1548    1549    1550    1551    1552
                   1553    1554    1555    1556    1557    1558    1559    1560
                   1561    1562    1563    1564    1565    1566    1567    1568
                   1569    1570    1571    1572    1573    1574    1575    1576
                   1577    1578    1579    1580    1581    1582    1583    1584
                   1585    1586    1587    1588    1589    1590    1591    1592
                   1593    1594    1595    1596    1597    1598    1599    1600
                   1601    1602    1603    1604    1605    1606    1607    1608
                   1609    1610    1611    1612    1613    1614    1615    1616
                   1617    1618    1619    1620    1621    1622    1623    1624
                   1625    1626    1627    1628    1629    1630    1631    1632
                   1633    1634    1635    1636    1637    1638    1639    1640
                   1641    1642    1643    1644    1645    1646    1647    1648
                   1649    1650    1651    1652    1653    1654    1655    1656
                   1657    1658    1659    1660    1661    1662    1663    1664
                   1665    1666    1667    1668    1669    1670    1671    1672
                   1673    1674    1675    1676    1677    1678    1679    1680
                   1681    1682    1683    1684    1685    1686    1687    1688
                   1689    1690    1691    1692    1693    1694    1695    1696
                   1697    1698    1699    1700    1701    1702    1703    1704
                   1705    1706    1707    1708    1709    1710    1711    1712
                   1713    1714    1715    1716    1717    1718    1719    1720
                   1721    1722    1723    1724    1725    1726    1727    1728
                   1729    1730    1731    1732    1733    1734    1735    1736
                   1737    1738    1739    1740    1741    1742    1743    1744
                   1745    1746    1747    1748    1749    1750    1751    1752
                   1753    1754    1755    1756    1757    1758    1759    1760
                   1761    1762    1763    1764    1765    1766    1767    1768
                   1769    1770    1771    1772    1773    1774    1775    1776
                   1777    1778    1779    1780    1781    1782    1783    1784
                   1785    1786    1787    1788    1789    1790    1791    1792
                   1793    1794    1795    1796    1797    1798    1799    1800
                   1801    1802    1803    1804    1805    1806    1807    1808
                   1809    1810    1811    1812    1813    1814    1815    1816
                   1817    1818    1819    1820    1821    1822    1823    1824
                   1825    1826    1827    1828    1829    1830    1831    1832
                   1833    1834    1835    1836    1837    1838    1839    1840
                   1841    1842    1843    1844    1845    1846    1847    1848
                   1849    1850    1851    1852    1853    1854    1855    1856
                   1857    1858    1859    1860    1861    1862    1863    1864
                   1865    1866    1867    1868    1869    1870    1871    1872
                   1873    1874    1875    1876    1877    1878    1879    1880
                   1881    1882    1883    1884    1885    1886    1887    1888
                   1889    1890    1891    1892    1893    1894    1895    1896
                   1897    1898    1899    1900    1901    1902    1903    1904
                   1905    1906    1907    1908    1909    1910    1911    1912
                   1913    1914    1915    1916    1917    1918    1919    1920
                   1921    1922    1923    1924    1925    1926    1927    1928
                   1929    1930    1931    1932    1933    1934    1935    1936
                   1937    1938    1939    1940    1941    1942    1943    1944
                   1945    1946    1947    1948    1949    1950    1951    1952
                   1953    1954    1955    1956    1957    1958    1959    1960
                   1961    1962    1963    1964    1965    1966    1967    1968
                   1969    1970    1971    1972    1973    1974    1975    1976
                   1977    1978    1979    1980    1981    1982    1983    1984
                   1985    1986    1987    1988    1989    1990    1991    1992
                   1993    1994    1995    1996    1997    1998    1999    2000
                   2001    2002    2003    2004    2005    2006    2007    2008
                   2009    2010    2011    2012    2013    2014    2015    2016
                   2017    2018    2019    2020    2021    2022    2023    2024
                   2025    2026    2027    2028    2029    2030    2031    2032
                   2033    2034    2035    2036    2037    2038    2039    2040
                   2041    2042    2043    2044    2045    2046    2047    2048
 element load imbalance:  0 512 512
 done :: mapelpr, mapping elements to processors

 gfdm/ifgtp/ifre2 F F T
   reading mesh 
   reading curved sides 
   reading bc for ifld 1
 done :: read .re2 file
  
 done :: close .rea file    .17675     sec

 done: readat2 :: 0.178290096249995145  sec
 call para_init2
 done: para_init2
 setup mesh topology
   Right-handed check complete for2048 elements. OK.
 0 512 15360 3072  Fgbtuple 8
   setvert3d:   8      260096      702464      260096      260096
   call usrsetvert
   done :: usrsetvert

gs_setup: 12544 unique labels shared
   pairwise times (avg, min, max): 3.61761e-05 3.60888e-05 3.62964e-05
   crystal router                : 0.00056151 0.000561474 0.000561545
   all reduce                    : 9.42517e-05 9.42428e-05 9.42571e-05
   used all_to_all method: pairwise
   handle bytes (avg, min, max): 1.83482e+06 1834820 1834820
   buffer bytes (avg, min, max): 100352 100352 100352
   setup_ds time 3.6476E-01 seconds   0  8      260096        2048
 setup_dgds2:: init
 0 512 15360 3072  Fgbtuple 10
   setvert3d:  10      444416     1492992      444416      444416
   call usrsetvert
   done :: usrsetvert

 set_vert time:: 7.4119E-02 seconds 
gs_setup: 16384 unique labels shared
   pairwise times (avg, min, max): 3.73808e-05 3.71999e-05 3.75452e-05
   crystal router                : 0.00071937 0.000719226 0.000719493
   used all_to_all method: pairwise
   all reduce                    : 0.000119068 0.000119065 0.000119071
   handle bytes (avg, min, max): 2.45792e+06 2457924 2457924
   buffer bytes (avg, min, max): 131072 131072 131072
   gs_setup time:: 3.9465E-01 seconds 
 setup_dsdg2 time:: 4.7368E-01 seconds   1  8      444416        2048
 done :: setup mesh topology
 .
 8  max multiplicity
npts/nelt/nxyz/nxzfl/nfield   262144      512      512   196608    1
 call usrdat
 done :: usrdat

 call set_options
 IFMAXWELL    T
 IFSCHROD     F
 IFDRIFT      F
 IFDRUDE      F
 IFLOREN      F
 IFBEAM       F
 IFWAKE       F
 IFMOVW       F
 IFFILTER     F
 IFNAPY       F
 IFWAKET      F
 IFVARDT      F
 IFPBG        F
 IFDIELEC     F
 IFPOISSON    F
 IFGMRES      F
 IFCG         F
 IFSEMG       F
 IFFDM        F
 IFIC         F
 IFSOL        T
 IFSRC        F
 IFSCAT       F
 IFSFTF       F
 IFCENTRAL    F
 IFUPWIND     T
 IFDEALIAS    F
 IFTM         F
 IFTE         T
 IFEIG        F
 IFEXP        F
 IFRK45       T
 IFRK44       F
 IFRK33       F
 IFRK22       F
 IFSIM5       F
 IFSIM4       F
 IFSIM3       F
 IFSIM2       F
 IFSIM1       F
 IFDTCTL      F
 IFPEC        F
 IFROB        F
 IFINHOM      F
 IFPML        F
 IFDTN        F
 IFNM         F
 IFRESTART    F
 
 cspeed   = 1.00000000000000000
 permit_0 = 1.00000000000000000
 permea_0 = 1.00000000000000000
 nmscale  = 1.00000000000000000
 
 done :: set_options

 call setlog
 ifflow/ifheat/nfield T F 1
 ifield0/nfld 1 1
 IFSTRS = F
 IFCHAR = F
 IFAXIS = F
 IFMVBD = F
 IFMELT = F
 IFMODEL= F
 IFKEPS = F
   
 IFVCOR = T
 IFINTQ = F
 IFCWUZ = F
 IFSWALL= F
 IFGEOM = F
 IFSURT = F
 IFWCNO = F
 IFCEM  = T
   
 IFADVC for field 1    =  F
 IFNONL for field 1    =  F
 done :: setlog

 call gengeom
 genwz
 gencoor
 geom1
 Vol: 7.99999999999710365 7.99999999999710365
 volumn
 setdef
 done :: generate geomerty data
  
 done :: gengeom

 call usrdat2
 done :: usrdat2

 call geom_reset
 this is bm2: 0.240053549215522901E-04
 Vol: 248.050213442383978 248.050213442383978
 done :: geom_reset

 call set_unr   
 done :: set_unr

  Mesh consistency check, OK.
 call load_semhat_weighted
 done :: load_semhat_weighted

 dofs: 0 1048576 38912
 
 Preprocessor options::  
   hpm off: -DHPM not defined
 

 IFMAXWELL    T
 IFSCHROD     F
 IFDRIFT      F
 IFDRUDE      F
 IFLOREN      F
 IFBEAM       F
 IFWAKE       F
 IFMOVW       F
 IFFILTER     F
 IFNAPY       F
 IFWAKET      F
 IFVARDT      F
 IFPBG        F
 IFDIELEC     F
 IFPOISSON    F
 IFGMRES      F
 IFCG         F
 IFSEMG       F
 IFFDM        F
 IFIC         F
 IFSOL        T
 IFSRC        F
 IFSCAT       F
 IFSFTF       F
 IFCENTRAL    F
 IFUPWIND     T
 IFDEALIAS    F
 IFTM         F
 IFTE         T
 IFEIG        F
 IFEXP        F
 IFRK45       T
 IFRK44       F
 IFRK33       F
 IFRK22       F
 IFSIM5       F
 IFSIM4       F
 IFSIM3       F
 IFSIM2       F
 IFSIM1       F
 IFDTCTL      F
 IFPEC        F
 IFROB        F
 IFINHOM      F
 IFPML        F
 IFDTN        F
 IFNM         F
 IFRESTART    F
 
 cspeed   = 1.00000000000000000
 permit_0 = 1.00000000000000000
 permea_0 = 1.00000000000000000
 nmscale  = 1.00000000000000000
 
 start: initialize geom and fields
 done: initialization geom/fields
 start: cem_set_fc_ptr, volume index j=cemface(i)
 done: cem_set_fc_ptr, ncemface=  196608
 npts 262144 8 8 8 512
 permit_max= 1.00000000000000000
 permit_min= 1.00000000000000000
 permea_max= 1.00000000000000000
 permea_min= 1.00000000000000000
 start: cem_maxwell_materials
 done: cem_maxwell_materials
 start: cem_alternatve_flux_ptr-> index setting
 done: cem_alternate_flux_ptr
 nid=0: gs_op_fields: single vector 0.734614550000003419E-01 sec
 nid=0: gs_op_fields: multi  vector 0.713832537499996533E-01 sec
 gs_op_fields: chose multi vector 
 done: inverse mass matrix
 
 dxmin= 0.200423704761192312E-01
 dt= 0.400847409522384675E-02 , CFL= 0.200000000000000011
 IFDRIFT= F
 usersol: done, IFSOL= T
 userini: done, IFSOL= T

    istep   nelt  nels  N  npt1    npts   time         dt     HXerr     HYerr     HZerr     EXerr     EYerr     EZerr    cpu_t   cpu_t_pts
         0  512   22    7  154   262144 0.000E+00 4.008E-03 0.000E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00 0.00E+00 CPU: L2  
         0  512   22    7  154   262144 0.000E+00 4.008E-03 0.000E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00 0.00E+00 CPU: Linf
 userchk: done, ifrestart= F
 IFRK,IFSIM,IFBDF T F F
 param(17): defined as  0.000000000000000000E+00
 initial time= 0.000000000000000000E+00 , final time= 0.100000000000000000E+21
 total nsteps= 1000
 iocomm= 1000 , iostep= 1000
 . 
 ============================
 ========  BEGIN RUN ========
 ============================
 istep=     1    to      1000

    istep   nelt  nels  N  npt1    npts   time         dt     HXerr     HYerr     HZerr     EXerr     EYerr     EZerr    cpu_t   cpu_t_pts
         1  512   22    7  154   262144 4.008E-03 4.008E-03 5.528E-12 5.528E-12 5.528E-12 1.118E-14 1.268E-13 1.761E-13 1.550E+00 5.91E-06 CPU: L2  
         1  512   22    7  154   262144 4.008E-03 4.008E-03 3.477E-11 3.479E-11 3.479E-11 7.300E-14 1.868E-12 2.101E-12 1.550E+00 5.91E-06 CPU: Linf

    istep   nelt  nels  N  npt1    npts   time         dt     HXerr     HYerr     HZerr     EXerr     EYerr     EZerr    cpu_t   cpu_t_pts
         2  512   22    7  154   262144 8.017E-03 4.008E-03 1.081E-11 1.081E-11 1.081E-11 4.398E-14 4.769E-13 6.643E-13 3.103E+00 5.92E-06 CPU: L2  
         2  512   22    7  154   262144 8.017E-03 4.008E-03 6.316E-11 6.320E-11 6.320E-11 2.705E-13 6.774E-12 8.564E-12 3.103E+00 5.92E-06 CPU: Linf

    istep   nelt  nels  N  npt1    npts   time         dt     HXerr     HYerr     HZerr     EXerr     EYerr     EZerr    cpu_t   cpu_t_pts
         3  512   22    7  154   262144 1.203E-02 4.008E-03 1.593E-11 1.592E-11 1.592E-11 9.758E-14 1.031E-12 1.442E-12 4.657E+00 5.92E-06 CPU: L2  
         3  512   22    7  154   262144 1.203E-02 4.008E-03 8.661E-11 8.666E-11 8.666E-11 5.725E-13 1.406E-11 1.950E-11 4.657E+00 5.92E-06 CPU: Linf

    istep   nelt  nels  N  npt1    npts   time         dt     HXerr     HYerr     HZerr     EXerr     EYerr     EZerr    cpu_t   cpu_t_pts
         4  512   22    7  154   262144 1.603E-02 4.008E-03 2.090E-11 2.090E-11 2.090E-11 1.713E-13 1.793E-12 2.516E-12 6.209E+00 5.92E-06 CPU: L2  
         4  512   22    7  154   262144 1.603E-02 4.008E-03 1.063E-10 1.064E-10 1.064E-10 9.607E-13 2.511E-11 3.485E-11 6.209E+00 5.92E-06 CPU: Linf

    istep   nelt  nels  N  npt1    npts   time         dt     HXerr     HYerr     HZerr     EXerr     EYerr     EZerr    cpu_t   cpu_t_pts
         5  512   22    7  154   262144 2.004E-02 4.008E-03 2.576E-11 2.576E-11 2.576E-11 2.648E-13 2.775E-12 3.905E-12 7.760E+00 5.92E-06 CPU: L2  
         5  512   22    7  154   262144 2.004E-02 4.008E-03 1.232E-10 1.233E-10 1.233E-10 1.422E-12 3.919E-11 5.556E-11 7.760E+00 5.92E-06 CPU: Linf

    istep   nelt  nels  N  npt1    npts   time         dt     HXerr     HYerr     HZerr     EXerr     EYerr     EZerr    cpu_t   cpu_t_pts
         6  512   22    7  154   262144 2.405E-02 4.008E-03 3.049E-11 3.049E-11 3.049E-11 3.774E-13 3.988E-12 5.624E-12 9.313E+00 5.92E-06 CPU: L2  
         6  512   22    7  154   262144 2.405E-02 4.008E-03 1.382E-10 1.382E-10 1.382E-10 1.947E-12 5.610E-11 8.231E-11 9.313E+00 5.92E-06 CPU: Linf

    istep   nelt  nels  N  npt1    npts   time         dt     HXerr     HYerr     HZerr     EXerr     EYerr     EZerr    cpu_t   cpu_t_pts
         7  512   22    7  154   262144 2.806E-02 4.008E-03 3.510E-11 3.509E-11 3.509E-11 5.087E-13 5.434E-12 7.677E-12 1.087E+01 5.92E-06 CPU: L2  
         7  512   22    7  154   262144 2.806E-02 4.008E-03 1.518E-10 1.517E-10 1.517E-10 2.529E-12 7.558E-11 1.141E-10 1.087E+01 5.92E-06 CPU: Linf

    istep   nelt  nels  N  npt1    npts   time         dt     HXerr     HYerr     HZerr     EXerr     EYerr     EZerr    cpu_t   cpu_t_pts
         8  512   22    7  154   262144 3.207E-02 4.008E-03 3.955E-11 3.955E-11 3.955E-11 6.581E-13 7.109E-12 1.006E-11 1.242E+01 5.92E-06 CPU: L2  
         8  512   22    7  154   262144 3.207E-02 4.008E-03 1.645E-10 1.645E-10 1.645E-10 3.163E-12 9.731E-11 1.523E-10 1.242E+01 5.92E-06 CPU: Linf

    istep   nelt  nels  N  npt1    npts   time         dt     HXerr     HYerr     HZerr     EXerr     EYerr     EZerr    cpu_t   cpu_t_pts
         9  512   22    7  154   262144 3.608E-02 4.008E-03 4.386E-11 4.386E-11 4.386E-11 8.251E-13 9.001E-12 1.275E-11 1.397E+01 5.92E-06 CPU: L2  
         9  512   22    7  154   262144 3.608E-02 4.008E-03 1.767E-10 1.767E-10 1.767E-10 3.848E-12 1.210E-10 2.006E-10 1.397E+01 5.92E-06 CPU: Linf

    istep   nelt  nels  N  npt1    npts   time         dt     HXerr     HYerr     HZerr     EXerr     EYerr     EZerr    cpu_t   cpu_t_pts
        10  512   22    7  154   262144 4.008E-02 4.008E-03 4.799E-11 4.799E-11 4.799E-11 1.009E-12 1.109E-11 1.571E-11 1.552E+01 5.92E-06 CPU: L2  
        10  512   22    7  154   262144 4.008E-02 4.008E-03 1.887E-10 1.888E-10 1.888E-10 4.581E-12 1.462E-10 2.544E-10 1.552E+01 5.92E-06 CPU: Linf

    istep   nelt  nels  N  npt1    npts   time         dt     HXerr     HYerr     HZerr     EXerr     EYerr     EZerr    cpu_t   cpu_t_pts
      1000  512   22    7  154   262144 4.008E+00 4.008E-03 8.569E-11 7.289E-11 7.272E-11 2.663E-11 6.427E-11 9.194E-11 1.553E+03 5.93E-06 CPU: L2  
      1000  512   22    7  154   262144 4.008E+00 4.008E-03 7.923E-10 5.390E-10 5.390E-10 1.699E-10 5.002E-10 1.088E-09 1.553E+03 5.93E-06 CPU: Linf

 max timestep=     1000; estimated remaining time (min)=       .00
 
 Preprocessor options::  
 
 IFSE=F, IFDG=T IFNEDELEC=F, IFCG=F, IFGMRES=F, IFDIRECT=F, IFGFDM=F, IFGFDMDD=F, IFFDM=F, IFSEMG=F
 SRC=F, TM=F, TE=T, CENTRAL=F, UPWIND=T, PML=F, PEC=F EIG=F, EXP=F, RK45=T, RK4=F, RK3=F, RK2=FSIM5=F, SIM4=F, SIM3=F, SIM2=F, SIM1=F, BDF1=F, BDF2=F
 DEALIAS=F, SCAT=F, SFTF=F, NM=F, DIELEC=F, FILTER=F, SOL=T, POISSON=F, DRUDE=F, LORENTZ=F, HYDRO=F, DRIFT=F, EXCT=F, INHOM=F, Dealias_M=  1, Krylov_Dim=  1

 

 setup: time2/time1/time2-time1:: 4.3289E+01 4.1338E+01 1.9517E+00 sec 
 solve: time2/time1/time2-time1:: 1.6050E+03 4.3291E+01 1.5618E+03 sec 
 total: time2/time1/time2-time1:: 1.6051E+03 4.1338E+01 1.5637E+03 sec 
 

 ===============================================================
    Job successfully completed !!!!   
 ===============================================================
 time meausures over np = 4
 setup  time (avg/nid0/max):: 1.9514E+00 1.9517E+00 1.9517E+00 sec 
 solve  time (avg/nid0/max):: 1.5618E+03 1.5618E+03 1.5618E+03 sec 
 total  time (avg/nid0/max):: 1.5637E+03 1.5637E+03 1.5637E+03 sec 
 ===============================================================
  total time measures (CPU + OMP + GPU)
    total computation         :: 1.5532E+03 sec 
    total communication       :: 3.5932E+02 sec 
    total io time             :: 0.0000E+00 sec 
    total userchk time        :: 5.8823E-01 sec 
    total computation/step    :: 1.5532E+00 sec 
    total communication /step :: 3.5932E-01 sec 
    total io time       /step :: 0.0000E+00 sec 
    computation time/step/pts :: 5.9251E-06 sec 
    io          time/step/pts :: 0.0000E+00 sec 
    io          swaptime      :: 0.0000E+00 sec 
    io/comp     time/step/pts):: 0.0000E+00 %   
    communication/computation :: 2.3134E+01 %   
 ===============================================================
  
call exitt: dying ...
  
  
total elapsed time             :   1.60506E+03 sec
total solver time incl. I/O    :   0.00000E+00 sec
time/timestep                  :   0.00000E+00 sec
CPU seconds/timestep/gridpt    :   0.00000E+00 sec

