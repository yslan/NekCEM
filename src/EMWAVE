C
C       Common block for cem model
C 

      COMMON /IWORK1/ iwork1 (2*LELT)
      COMMON /IWORK2/ iwork2 (4*(LDIM-1)*LELT)
      COMMON /IWORK3/ iwork3 (4*(LDIM-1)*LELT)
      integer iwork1, iwork2, iwork3

      COMMON /FMAT/  ZIMPEDE (lxzf1)
     $             , YCONDUC (lxzf1)
     $             , Y_0     (lxzf1)
     $             , Y_1     (lxzf1)
     $             , Z_0     (lxzf1)
     $             , Z_1     (lxzf1)
     $             , FACEF   (lxzf1)
     $             , F_0     (lxzf1)

      real zimpede,yconduc,facef,y_0,y_1,z_0,z_1,f_0        

      COMMON /RKABC/ RKtime

      COMMON /EFLG/ IFCENTRAL,IFUPWIND,IFSRC,IFDRUDE,IFPML,IFPPP,IFPP,
     $ IFEIG,IFWAVEGUIDE,IFPEC,IFDTN,IFPMC,IFTM,IFTE,IFNM,IFDEALIAS,
     $ IFFILTER,IFEXP,IFRK,IFRK45,IFRK44,IFRK33,IFRK22, 
     $ IFSIM,IFSIM5,IFSIM4,IFSIM3,IFSIM2,IFSIM1,
     $ IFPOISSON,IFIC,IFRESTART,IFBEAM,IFWAKE,IFSRFINT,IFVARDT,IFWAKET,                                 
     $ IFNAPY,IFMOVW,IFSFTF,IFLOREN,IFSOL,IFSCAT,IFDIELEC,IFVTK,       
     $ IFDTCTL,IFPBG,IFDOUBLE,                          
     $ IFMAXWELL,IFSCHROD,IFCG,IFGMRES                                 

      LOGICAL       IFCENTRAL,IFUPWIND,IFSRC,IFDRUDE,IFPML,IFPPP,IFPP,
     $ IFEIG,IFWAVEGUIDE,IFPEC,IFDTN,IFPMC,IFTM,IFTE,IFNM,IFDEALIAS,
     $ IFFILTER,IFEXP,IFRK,IFRK45,IFRK44,IFRK33,IFRK22, 
     $ IFSIM,IFSIM5,IFSIM4,IFSIM3,IFSIM2,IFSIM1,
     $ IFPOISSON,IFIC,IFRESTART,IFBEAM,IFWAKE,IFSRFINT,IFVARDT,IFWAKET,
     $ IFNAPY,IFMOVW,IFSFTF,IFLOREN,IFSOL,IFSCAT,IFDIELEC,IFVTK,       
     $ IFDTCTL,IFPBG,IFDOUBLE,                           
     $ IFMAXWELL,IFSCHROD,IFCG,IFGMRES                                 

      integer lr2
      parameter (lr2=lx1*lx1)
      common /ahat/ ah (lr2),bh (lr2),ch (lr2),dh (lr2)

      COMMON /cemfce1/ cemface (2*ldim*lx1*lz1*lelt)
     $               , cemslice(2*ldim*lx1*lz1*lelt)
      COMMON /cemfce2/ ncemface,ncemslice                         
      integer          cemface, cemslice,ncemface,ncemslice

      COMMON /MEDIA/ 
     $               DRUDEA (lpts1)
     $             , DRUDEB (lpts1)
     $             , IMPEDE (lpts1)
     $             , CONDUC (lpts1)
     $             , FACEIF (lpts1)
      real    drudea,drudeb,impede,conduc,faceif

      COMMON /MLOREN/
     $               LORENA (lpts1,3)
     $             , LORENB (lpts1,3)
     $             , LORENC (lpts1,3)
      real           lorena,lorenb,lorenc

      COMMON /NEKWAV/ cspeed,eta_1,eta_2,Ttr,Rre,Ttr2,Rre2
      real            cspeed,eta_1,eta_2,Ttr,Rre,Ttr2,Rre2

      COMMON /REGIONI/ if_in_region(lelt)
      integer          if_in_region


      COMMON /DRUDEP/  drude_alpha, drude_beta
      REAL             drude_alpha, drude_beta
      COMMON /EMMOD/   imode
      integer          imode                      

      COMMON /BEAMP/   rsigma,zsigma,tsigma,zposition,zcut
      COMMON /WAKEP/   wakerad1,wakerad2,offaxis,smin,smax
      COMMON /NAPYP/   wnapy1,wnapy2,wzone1,wzone2                    
   
      common /SCALS/   nmscale,xyzscale,sscale,upscale,bound,fldmax
      real             nmscale,xyzscale,sscale,upscale,bound,fldmax

      common /NPER/    n_period,nperiod,nopstep 
      integer          n_period,nperiod,nopstep   

      common /DTLOG/   dtchk                             
      logical          dtchk
      common /DTCNT/   idtchg                             
      integer          idtchg

      common /EDIR/    eltdir(lelt)
      character*5      eltdir

      common /mvframe/ mw0,mw1,mw2,mwcnt
      integer          mw0,mw1,mw2,mwcnt
      common /transpa/ tsurface,trans_scat,trans_tot,trans_inc,
     $                 xminval,yminval,zminval,
     $                 xmaxval,ymaxval,zmaxval
      real             tsurface,trans_scat,trans_tot,trans_inc,
     $                 xminval,yminval,zminval,
     $                 xmaxval,ymaxval,zmaxval

      common /emflags/ incflag
      integer          incflag                

      common /irstrt/  irststep, irstdumpno
      integer          irststep, irstdumpno

      common /basescat/  outpml                     
      real outpml      (lx1,ly1,lz1,lelt)


C
C       Common block for cem model
C

      COMMON /MAXWELLV/  
     $               SHN (lpts1,3)
     $             , SEN (lpts1,3)
     $             , HN  (lpts1,3)
     $             , EN  (lpts1,3)
     $             , kHN (lpts1,3)
     $             , kEN (lpts1,3)
     $             , resHN (lpts1,3)
     $             , resEN (lpts1,3)
      real           SHN,SEN,HN,EN
      real           kHN,kEN
      real           resHN,resEN


      COMMON /MAXWELLD/
     $               JN1   (lpts1,3)      
     $             , JN2   (lpts1,3)      
     $             , JN3   (lpts1,3)      
     $             , PN1   (lpts1,3)      
     $             , PN2   (lpts1,3)      
     $             , PN3   (lpts1,3)      
     $             , kJN1  (lpts1,3)
     $             , kJN2  (lpts1,3)
     $             , kJN3  (lpts1,3)
     $             , kPN1  (lpts1,3)
     $             , kPN2  (lpts1,3)
     $             , kPN3  (lpts1,3)
     $             , resJN1(lpts1,3)
     $             , resJN2(lpts1,3)
     $             , resJN3(lpts1,3)
     $             , resPN1(lpts1,3)
     $             , resPN2(lpts1,3)
     $             , resPN3(lpts1,3)
      real           JN1,JN2,JN3
      real           PN1,PN2,PN3
      real           kJN1,kJN2,kJN3
      real           kPN1,kPN2,kPN3
      real           resJN1,resJN2,resJN3
      real           resPN1,resPN2,resPN3

      COMMON /MAXWELLP/ 
     $               kBN (lpts1,3)           
     $             , kDN (lpts1,3)          
      real           kBN,kDN
      
      COMMON /MAXWELLE/
     $               errHN (lpts1,3)
     $             , errEN (lpts1,3)          
      real           errHN,errEN

      COMMON /MAXWELLM/ 
     $               HBM1 (lpts1)           
     $             , EBM1 (lpts1)
      real           HBM1,EBM1

      COMMON /MAXWELLF/ 
     $               fHN (lxzf1,3)  
     $             , fEN (lxzf1,3)               
      real           fHN,fEN

      COMMON /MAXWELLQ/  
     $               permittivity(lpts1)
     $             , permeability(lpts1)
      real           permittivity,permeability
